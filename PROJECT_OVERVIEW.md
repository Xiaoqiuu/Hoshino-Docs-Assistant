# Hoshino 文档助手 - 项目概览

## 项目简介

Hoshino 是一个基于 Electron + React + TypeScript 构建的轻量级 AI 文档问答助手。它通过全局快捷键快速唤出，支持普通对话和基于文档的 RAG（检索增强生成）问答两种模式。

## 核心功能

### 1. 全局快捷键唤出
- 默认快捷键：`Ctrl+Alt+H`（可自定义）
- 无论当前焦点在哪个应用，都能快速唤出
- 窗口失焦自动隐藏，不干扰工作流

### 2. 双模式交互

**普通对话模式**
- 未检测到选中文本时激活
- 与 AI 进行自由对话
- 适合快速查询、头脑风暴等场景

**文档问答模式（RAG）**
- 检测到选中文本时自动激活
- 基于文档上下文进行问答
- 提供来源引用和页码
- 支持跳转到原文位置

### 3. 后台常驻
- 系统托盘图标
- 低资源占用
- 开机自启动（可选）

## 技术架构

```
┌─────────────────────────────────────────┐
│           Electron 主进程                │
│  ┌─────────────────────────────────┐   │
│  │  窗口管理 | 快捷键 | 托盘图标    │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │      IPC 通信处理器              │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │  文档解析 | RAG | AI 模型调用   │   │
│  └─────────────────────────────────┘   │
└─────────────────────────────────────────┘
                    ↕ IPC
┌─────────────────────────────────────────┐
│         React 渲染进程 (UI)              │
│  ┌─────────────────────────────────┐   │
│  │    输入框 | 消息列表 | 来源展示  │   │
│  └─────────────────────────────────┘   │
└─────────────────────────────────────────┘
```

## 当前实现状态

### ✅ 已完成
- [x] 项目基础架构搭建
- [x] Electron + React + TypeScript 配置
- [x] 全局快捷键注册
- [x] 窗口管理和托盘图标
- [x] 基础 UI 界面
- [x] IPC 通信框架
- [x] 双模式 UI 切换

### 🚧 待实现（核心功能）
- [ ] AI 模型 API 集成（DeepSeek/OpenAI）
- [ ] 文档解析服务（PDF/DOCX）
- [ ] 向量数据库集成（FAISS/Chroma）
- [ ] RAG 检索和生成流程
- [ ] 系统选中文本获取
- [ ] 设置面板和配置管理

### 📋 待实现（增强功能）
- [ ] 浏览器扩展（Chrome/Firefox）
- [ ] 文档跳转功能
- [ ] 会话历史管理
- [ ] 本地模型支持
- [ ] OCR 支持

## 开发路线图

### Phase 1: MVP (当前阶段)
**目标**: 实现基本可用的文档问答功能

1. **AI 模型集成** (优先级: 高)
   - 集成 DeepSeek API
   - 实现基本对话功能
   - 错误处理和重试机制

2. **文档解析** (优先级: 高)
   - PDF 文本提取
   - 文档分块（chunking）
   - 元数据提取（页码等）

3. **简单 RAG** (优先级: 高)
   - 基于关键词的简单检索
   - 上下文拼接
   - 来源标注

### Phase 2: 增强
**目标**: 提升用户体验和功能完整性

1. **向量检索**
   - 嵌入生成
   - 向量数据库集成
   - 语义检索

2. **浏览器集成**
   - Chrome 扩展
   - 网页文本获取
   - 与桌面应用通信

3. **设置管理**
   - API Key 配置
   - 模型选择
   - 快捷键自定义

### Phase 3: 高级功能
**目标**: 企业级功能和性能优化

1. **本地模型**
2. **多文档检索**
3. **图表理解**
4. **团队协作**

## 关键技术点

### 1. 全局快捷键
使用 Electron 的 `globalShortcut` API：
```typescript
globalShortcut.register('CommandOrControl+Alt+H', () => {
  toggleWindow();
});
```

### 2. 窗口管理
- 无边框透明窗口
- 失焦自动隐藏
- 多显示器支持

### 3. 安全通信
- Context Isolation
- Preload Script
- 有限的 API 暴露

### 4. RAG 流程
```
用户问题 → 文档检索 → 上下文拼接 → AI 生成 → 来源标注
```

## 性能目标

- 窗口唤出: < 300ms
- 文档索引: < 30s (100页)
- RAG 响应: < 3s
- 内存占用: < 200MB (空闲)

## 安全考虑

1. **API Key 安全**
   - 使用系统钥匙串存储
   - 不在日志中记录

2. **数据隐私**
   - 本地处理选项
   - 敏感信息过滤
   - 可选的云端上传

3. **防注入攻击**
   - 输入验证
   - Prompt 防护
   - 来源验证

## 依赖项

### 核心依赖
- electron: ^28.0.0
- react: ^18.2.0
- typescript: ^5.3.3
- vite: ^5.0.8

### 待添加依赖
- pdf-parse: PDF 解析
- mammoth: DOCX 解析
- @langchain/community: RAG 工具链
- faiss-node 或 chromadb: 向量数据库

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交代码
4. 创建 Pull Request

## 许可证

MIT License

---

**最后更新**: 2025-01-12
**当前版本**: v0.1.0 (MVP 开发中)
